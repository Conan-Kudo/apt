// -*- mode: cpp; mode: fold -*-
// Description								/*{{{*/
// $Id: crc-16.cc,v 1.1 1999/05/23 22:55:54 jgg Exp $
/* ######################################################################
   
   CRC16 - Compute a 16bit crc very quickly
   
   This was ripped out of the linux 2.2 kernel source (irda/crc.c) and
   is credited to ppp.c by Michael Callahan <callahan@maths.ox.ac.uk> and
   Al Longyear <longyear@netcom.com>
   
   Modified by Jason Gunthorpe <jgg@debian.org> to fit the local coding
   style, this code is believed to be in the Public Domain.
   
   ##################################################################### */
									/*}}}*/
// Include Files							/*{{{*/
#include <config.h>
#include <endian.h>
#include <stdint.h>
#include <stdio.h>

#include <apt-pkg/crc-16.h>
									/*}}}*/

/*
 * This mysterious table is just the CRC of each possible byte.  It can be
 * computed using the standard bit-at-a-time methods.  The polynomial can
 * be seen in entry 128, 0x8408.  This corresponds to x^0 + x^5 + x^12.
 * Add the implicit x^16, and you have the standard CRC-CCITT.
 */
static unsigned short const crc16_table[8][256] = {
	{
		0x0000, 0x1189, 0x2312, 0x329b, 0x4624, 0x57ad, 0x6536, 0x74bf,
		0x8c48, 0x9dc1, 0xaf5a, 0xbed3, 0xca6c, 0xdbe5, 0xe97e, 0xf8f7,
		0x1081, 0x0108, 0x3393, 0x221a, 0x56a5, 0x472c, 0x75b7, 0x643e,
		0x9cc9, 0x8d40, 0xbfdb, 0xae52, 0xdaed, 0xcb64, 0xf9ff, 0xe876,
		0x2102, 0x308b, 0x0210, 0x1399, 0x6726, 0x76af, 0x4434, 0x55bd,
		0xad4a, 0xbcc3, 0x8e58, 0x9fd1, 0xeb6e, 0xfae7, 0xc87c, 0xd9f5,
		0x3183, 0x200a, 0x1291, 0x0318, 0x77a7, 0x662e, 0x54b5, 0x453c,
		0xbdcb, 0xac42, 0x9ed9, 0x8f50, 0xfbef, 0xea66, 0xd8fd, 0xc974,
		0x4204, 0x538d, 0x6116, 0x709f, 0x0420, 0x15a9, 0x2732, 0x36bb,
		0xce4c, 0xdfc5, 0xed5e, 0xfcd7, 0x8868, 0x99e1, 0xab7a, 0xbaf3,
		0x5285, 0x430c, 0x7197, 0x601e, 0x14a1, 0x0528, 0x37b3, 0x263a,
		0xdecd, 0xcf44, 0xfddf, 0xec56, 0x98e9, 0x8960, 0xbbfb, 0xaa72,
		0x6306, 0x728f, 0x4014, 0x519d, 0x2522, 0x34ab, 0x0630, 0x17b9,
		0xef4e, 0xfec7, 0xcc5c, 0xddd5, 0xa96a, 0xb8e3, 0x8a78, 0x9bf1,
		0x7387, 0x620e, 0x5095, 0x411c, 0x35a3, 0x242a, 0x16b1, 0x0738,
		0xffcf, 0xee46, 0xdcdd, 0xcd54, 0xb9eb, 0xa862, 0x9af9, 0x8b70,
		0x8408, 0x9581, 0xa71a, 0xb693, 0xc22c, 0xd3a5, 0xe13e, 0xf0b7,
		0x0840, 0x19c9, 0x2b52, 0x3adb, 0x4e64, 0x5fed, 0x6d76, 0x7cff,
		0x9489, 0x8500, 0xb79b, 0xa612, 0xd2ad, 0xc324, 0xf1bf, 0xe036,
		0x18c1, 0x0948, 0x3bd3, 0x2a5a, 0x5ee5, 0x4f6c, 0x7df7, 0x6c7e,
		0xa50a, 0xb483, 0x8618, 0x9791, 0xe32e, 0xf2a7, 0xc03c, 0xd1b5,
		0x2942, 0x38cb, 0x0a50, 0x1bd9, 0x6f66, 0x7eef, 0x4c74, 0x5dfd,
		0xb58b, 0xa402, 0x9699, 0x8710, 0xf3af, 0xe226, 0xd0bd, 0xc134,
		0x39c3, 0x284a, 0x1ad1, 0x0b58, 0x7fe7, 0x6e6e, 0x5cf5, 0x4d7c,
		0xc60c, 0xd785, 0xe51e, 0xf497, 0x8028, 0x91a1, 0xa33a, 0xb2b3,
		0x4a44, 0x5bcd, 0x6956, 0x78df, 0x0c60, 0x1de9, 0x2f72, 0x3efb,
		0xd68d, 0xc704, 0xf59f, 0xe416, 0x90a9, 0x8120, 0xb3bb, 0xa232,
		0x5ac5, 0x4b4c, 0x79d7, 0x685e, 0x1ce1, 0x0d68, 0x3ff3, 0x2e7a,
		0xe70e, 0xf687, 0xc41c, 0xd595, 0xa12a, 0xb0a3, 0x8238, 0x93b1,
		0x6b46, 0x7acf, 0x4854, 0x59dd, 0x2d62, 0x3ceb, 0x0e70, 0x1ff9,
		0xf78f, 0xe606, 0xd49d, 0xc514, 0xb1ab, 0xa022, 0x92b9, 0x8330,
		0x7bc7, 0x6a4e, 0x58d5, 0x495c, 0x3de3, 0x2c6a, 0x1ef1, 0x0f78
	},
	{
		0x0000, 0x19d8, 0x33b0, 0x2a68, 0x6760, 0x7eb8, 0x54d0, 0x4d08,
		0x31c0, 0x2818, 0x0270, 0x1ba8, 0x56a0, 0x4f78, 0x6510, 0x7cc8,
		0x9591, 0x8c49, 0xa621, 0xbff9, 0xf2f1, 0xeb29, 0xc141, 0xd899,
		0xa451, 0xbd89, 0x97e1, 0x8e39, 0xc331, 0xdae9, 0xf081, 0xe959,
		0x2333, 0x3aeb, 0x1083, 0x095b, 0x4453, 0x5d8b, 0x77e3, 0x6e3b,
		0x12f3, 0x0b2b, 0x2143, 0x389b, 0x7593, 0x6c4b, 0x4623, 0x5ffb,
		0xb6a2, 0xaf7a, 0x8512, 0x9cca, 0xd1c2, 0xc81a, 0xe272, 0xfbaa,
		0x8762, 0x9eba, 0xb4d2, 0xad0a, 0xe002, 0xf9da, 0xd3b2, 0xca6a,
		0x4666, 0x5fbe, 0x75d6, 0x6c0e, 0x2106, 0x38de, 0x12b6, 0x0b6e,
		0x77a6, 0x6e7e, 0x4416, 0x5dce, 0x10c6, 0x091e, 0x2376, 0x3aae,
		0xd3f7, 0xca2f, 0xe047, 0xf99f, 0xb497, 0xad4f, 0x8727, 0x9eff,
		0xe237, 0xfbef, 0xd187, 0xc85f, 0x8557, 0x9c8f, 0xb6e7, 0xaf3f,
		0x6555, 0x7c8d, 0x56e5, 0x4f3d, 0x0235, 0x1bed, 0x3185, 0x285d,
		0x5495, 0x4d4d, 0x6725, 0x7efd, 0x33f5, 0x2a2d, 0x0045, 0x199d,
		0xf0c4, 0xe91c, 0xc374, 0xdaac, 0x97a4, 0x8e7c, 0xa414, 0xbdcc,
		0xc104, 0xd8dc, 0xf2b4, 0xeb6c, 0xa664, 0xbfbc, 0x95d4, 0x8c0c,
		0x73cc, 0x6a14, 0x407c, 0x59a4, 0x14ac, 0x0d74, 0x271c, 0x3ec4,
		0x420c, 0x5bd4, 0x71bc, 0x6864, 0x256c, 0x3cb4, 0x16dc, 0x0f04,
		0xe65d, 0xff85, 0xd5ed, 0xcc35, 0x813d, 0x98e5, 0xb28d, 0xab55,
		0xd79d, 0xce45, 0xe42d, 0xfdf5, 0xb0fd, 0xa925, 0x834d, 0x9a95,
		0x50ff, 0x4927, 0x634f, 0x7a97, 0x379f, 0x2e47, 0x042f, 0x1df7,
		0x613f, 0x78e7, 0x528f, 0x4b57, 0x065f, 0x1f87, 0x35ef, 0x2c37,
		0xc56e, 0xdcb6, 0xf6de, 0xef06, 0xa20e, 0xbbd6, 0x91be, 0x8866,
		0xf4ae, 0xed76, 0xc71e, 0xdec6, 0x93ce, 0x8a16, 0xa07e, 0xb9a6,
		0x35aa, 0x2c72, 0x061a, 0x1fc2, 0x52ca, 0x4b12, 0x617a, 0x78a2,
		0x046a, 0x1db2, 0x37da, 0x2e02, 0x630a, 0x7ad2, 0x50ba, 0x4962,
		0xa03b, 0xb9e3, 0x938b, 0x8a53, 0xc75b, 0xde83, 0xf4eb, 0xed33,
		0x91fb, 0x8823, 0xa24b, 0xbb93, 0xf69b, 0xef43, 0xc52b, 0xdcf3,
		0x1699, 0x0f41, 0x2529, 0x3cf1, 0x71f9, 0x6821, 0x4249, 0x5b91,
		0x2759, 0x3e81, 0x14e9, 0x0d31, 0x4039, 0x59e1, 0x7389, 0x6a51,
		0x8308, 0x9ad0, 0xb0b8, 0xa960, 0xe468, 0xfdb0, 0xd7d8, 0xce00,
		0xb2c8, 0xab10, 0x8178, 0x98a0, 0xd5a8, 0xcc70, 0xe618, 0xffc0
	},
	{
		0x0000, 0x5adc, 0xb5b8, 0xef64, 0x6361, 0x39bd, 0xd6d9, 0x8c05,
		0xc63d, 0x9ce1, 0x7385, 0x2959, 0xa55c, 0xff80, 0x10e4, 0x4a38,
		0x7a95, 0x2049, 0xcf2d, 0x95f1, 0x19f4, 0x4328, 0xac4c, 0xf690,
		0xbca8, 0xe674, 0x0910, 0x53cc, 0xdfc9, 0x8515, 0x6a71, 0x30ad,
		0x033b, 0x59e7, 0xb683, 0xec5f, 0x605a, 0x3a86, 0xd5e2, 0x8f3e,
		0xc506, 0x9fda, 0x70be, 0x2a62, 0xa667, 0xfcbb, 0x13df, 0x4903,
		0x79ae, 0x2372, 0xcc16, 0x96ca, 0x1acf, 0x4013, 0xaf77, 0xf5ab,
		0xbf93, 0xe54f, 0x0a2b, 0x50f7, 0xdcf2, 0x862e, 0x694a, 0x3396,
		0x0676, 0x5caa, 0xb3ce, 0xe912, 0x6517, 0x3fcb, 0xd0af, 0x8a73,
		0xc04b, 0x9a97, 0x75f3, 0x2f2f, 0xa32a, 0xf9f6, 0x1692, 0x4c4e,
		0x7ce3, 0x263f, 0xc95b, 0x9387, 0x1f82, 0x455e, 0xaa3a, 0xf0e6,
		0xbade, 0xe002, 0x0f66, 0x55ba, 0xd9bf, 0x8363, 0x6c07, 0x36db,
		0x054d, 0x5f91, 0xb0f5, 0xea29, 0x662c, 0x3cf0, 0xd394, 0x8948,
		0xc370, 0x99ac, 0x76c8, 0x2c14, 0xa011, 0xfacd, 0x15a9, 0x4f75,
		0x7fd8, 0x2504, 0xca60, 0x90bc, 0x1cb9, 0x4665, 0xa901, 0xf3dd,
		0xb9e5, 0xe339, 0x0c5d, 0x5681, 0xda84, 0x8058, 0x6f3c, 0x35e0,
		0x0c13, 0x56cf, 0xb9ab, 0xe377, 0x6f72, 0x35ae, 0xdaca, 0x8016,
		0xca2e, 0x90f2, 0x7f96, 0x254a, 0xa94f, 0xf393, 0x1cf7, 0x462b,
		0x7686, 0x2c5a, 0xc33e, 0x99e2, 0x15e7, 0x4f3b, 0xa05f, 0xfa83,
		0xb0bb, 0xea67, 0x0503, 0x5fdf, 0xd3da, 0x8906, 0x6662, 0x3cbe,
		0x0f28, 0x55f4, 0xba90, 0xe04c, 0x6c49, 0x3695, 0xd9f1, 0x832d,
		0xc915, 0x93c9, 0x7cad, 0x2671, 0xaa74, 0xf0a8, 0x1fcc, 0x4510,
		0x75bd, 0x2f61, 0xc005, 0x9ad9, 0x16dc, 0x4c00, 0xa364, 0xf9b8,
		0xb380, 0xe95c, 0x0638, 0x5ce4, 0xd0e1, 0x8a3d, 0x6559, 0x3f85,
		0x0a65, 0x50b9, 0xbfdd, 0xe501, 0x6904, 0x33d8, 0xdcbc, 0x8660,
		0xcc58, 0x9684, 0x79e0, 0x233c, 0xaf39, 0xf5e5, 0x1a81, 0x405d,
		0x70f0, 0x2a2c, 0xc548, 0x9f94, 0x1391, 0x494d, 0xa629, 0xfcf5,
		0xb6cd, 0xec11, 0x0375, 0x59a9, 0xd5ac, 0x8f70, 0x6014, 0x3ac8,
		0x095e, 0x5382, 0xbce6, 0xe63a, 0x6a3f, 0x30e3, 0xdf87, 0x855b,
		0xcf63, 0x95bf, 0x7adb, 0x2007, 0xac02, 0xf6de, 0x19ba, 0x4366,
		0x73cb, 0x2917, 0xc673, 0x9caf, 0x10aa, 0x4a76, 0xa512, 0xffce,
		0xb5f6, 0xef2a, 0x004e, 0x5a92, 0xd697, 0x8c4b, 0x632f, 0x39f3
	},
	{
		0x0000, 0x1cbb, 0xc676, 0xdacd, 0x72ec, 0x6e57, 0xb49a, 0xa821,
		0x15a0, 0x091b, 0xd3d6, 0xcf6d, 0x674c, 0x7bf7, 0xa13a, 0xbd81,
		0xc35e, 0xdfe5, 0x0528, 0x1993, 0xb1b2, 0xad09, 0x77c4, 0x6b7f,
		0xd6fe, 0xca45, 0x1088, 0x0c33, 0xa412, 0xb8a9, 0x6264, 0x7edf,
		0x8f53, 0x93e8, 0x4925, 0x559e, 0xfdbf, 0xe104, 0x3bc9, 0x2772,
		0x9af3, 0x8648, 0x5c85, 0x403e, 0xe81f, 0xf4a4, 0x2e69, 0x32d2,
		0x4c0d, 0x50b6, 0x8a7b, 0x96c0, 0x3ee1, 0x225a, 0xf897, 0xe42c,
		0x59ad, 0x4516, 0x9fdb, 0x8360, 0x2b41, 0x37fa, 0xed37, 0xf18c,
		0x16b7, 0x0a0c, 0xd0c1, 0xcc7a, 0x645b, 0x78e0, 0xa22d, 0xbe96,
		0x0317, 0x1fac, 0xc561, 0xd9da, 0x71fb, 0x6d40, 0xb78d, 0xab36,
		0xd5e9, 0xc952, 0x139f, 0x0f24, 0xa705, 0xbbbe, 0x6173, 0x7dc8,
		0xc049, 0xdcf2, 0x063f, 0x1a84, 0xb2a5, 0xae1e, 0x74d3, 0x6868,
		0x99e4, 0x855f, 0x5f92, 0x4329, 0xeb08, 0xf7b3, 0x2d7e, 0x31c5,
		0x8c44, 0x90ff, 0x4a32, 0x5689, 0xfea8, 0xe213, 0x38de, 0x2465,
		0x5aba, 0x4601, 0x9ccc, 0x8077, 0x2856, 0x34ed, 0xee20, 0xf29b,
		0x4f1a, 0x53a1, 0x896c, 0x95d7, 0x3df6, 0x214d, 0xfb80, 0xe73b,
		0x2216, 0x3ead, 0xe460, 0xf8db, 0x50fa, 0x4c41, 0x968c, 0x8a37,
		0x37b6, 0x2b0d, 0xf1c0, 0xed7b, 0x455a, 0x59e1, 0x832c, 0x9f97,
		0xe148, 0xfdf3, 0x273e, 0x3b85, 0x93a4, 0x8f1f, 0x55d2, 0x4969,
		0xf4e8, 0xe853, 0x329e, 0x2e25, 0x8604, 0x9abf, 0x4072, 0x5cc9,
		0xad45, 0xb1fe, 0x6b33, 0x7788, 0xdfa9, 0xc312, 0x19df, 0x0564,
		0xb8e5, 0xa45e, 0x7e93, 0x6228, 0xca09, 0xd6b2, 0x0c7f, 0x10c4,
		0x6e1b, 0x72a0, 0xa86d, 0xb4d6, 0x1cf7, 0x004c, 0xda81, 0xc63a,
		0x7bbb, 0x6700, 0xbdcd, 0xa176, 0x0957, 0x15ec, 0xcf21, 0xd39a,
		0x34a1, 0x281a, 0xf2d7, 0xee6c, 0x464d, 0x5af6, 0x803b, 0x9c80,
		0x2101, 0x3dba, 0xe777, 0xfbcc, 0x53ed, 0x4f56, 0x959b, 0x8920,
		0xf7ff, 0xeb44, 0x3189, 0x2d32, 0x8513, 0x99a8, 0x4365, 0x5fde,
		0xe25f, 0xfee4, 0x2429, 0x3892, 0x90b3, 0x8c08, 0x56c5, 0x4a7e,
		0xbbf2, 0xa749, 0x7d84, 0x613f, 0xc91e, 0xd5a5, 0x0f68, 0x13d3,
		0xae52, 0xb2e9, 0x6824, 0x749f, 0xdcbe, 0xc005, 0x1ac8, 0x0673,
		0x78ac, 0x6417, 0xbeda, 0xa261, 0x0a40, 0x16fb, 0xcc36, 0xd08d,
		0x6d0c, 0x71b7, 0xab7a, 0xb7c1, 0x1fe0, 0x035b, 0xd996, 0xc52d
	},
	{
		0x0000, 0x0b44, 0xe977, 0xe233, 0x2d10, 0x2654, 0xc467, 0xcf23,
		0xa51f, 0xae5b, 0x4c68, 0x472c, 0x880f, 0x834b, 0x6178, 0x6a3c,
		0x4438, 0x4f7c, 0xad4f, 0xa60b, 0x6928, 0x626c, 0x805f, 0x8b1b,
		0xe127, 0xea63, 0x0850, 0x0314, 0xcc37, 0xc773, 0x2540, 0x2e04,
		0x9f91, 0x94d5, 0x76e6, 0x7da2, 0xb281, 0xb9c5, 0x5bf6, 0x50b2,
		0x3a8e, 0x31ca, 0xd3f9, 0xd8bd, 0x179e, 0x1cda, 0xfee9, 0xf5ad,
		0xdba9, 0xd0ed, 0x32de, 0x399a, 0xf6b9, 0xfdfd, 0x1fce, 0x148a,
		0x7eb6, 0x75f2, 0x97c1, 0x9c85, 0x53a6, 0x58e2, 0xbad1, 0xb195,
		0xc122, 0xca66, 0x2855, 0x2311, 0xec32, 0xe776, 0x0545, 0x0e01,
		0x643d, 0x6f79, 0x8d4a, 0x860e, 0x492d, 0x4269, 0xa05a, 0xab1e,
		0x851a, 0x8e5e, 0x6c6d, 0x6729, 0xa80a, 0xa34e, 0x417d, 0x4a39,
		0x2005, 0x2b41, 0xc972, 0xc236, 0x0d15, 0x0651, 0xe462, 0xef26,
		0x5eb3, 0x55f7, 0xb7c4, 0xbc80, 0x73a3, 0x78e7, 0x9ad4, 0x9190,
		0xfbac, 0xf0e8, 0x12db, 0x199f, 0xd6bc, 0xddf8, 0x3fcb, 0x348f,
		0x1a8b, 0x11cf, 0xf3fc, 0xf8b8, 0x379b, 0x3cdf, 0xdeec, 0xd5a8,
		0xbf94, 0xb4d0, 0x56e3, 0x5da7, 0x9284, 0x99c0, 0x7bf3, 0x70b7,
		0x7595, 0x7ed1, 0x9ce2, 0x97a6, 0x5885, 0x53c1, 0xb1f2, 0xbab6,
		0xd08a, 0xdbce, 0x39fd, 0x32b9, 0xfd9a, 0xf6de, 0x14ed, 0x1fa9,
		0x31ad, 0x3ae9, 0xd8da, 0xd39e, 0x1cbd, 0x17f9, 0xf5ca, 0xfe8e,
		0x94b2, 0x9ff6, 0x7dc5, 0x7681, 0xb9a2, 0xb2e6, 0x50d5, 0x5b91,
		0xea04, 0xe140, 0x0373, 0x0837, 0xc714, 0xcc50, 0x2e63, 0x2527,
		0x4f1b, 0x445f, 0xa66c, 0xad28, 0x620b, 0x694f, 0x8b7c, 0x8038,
		0xae3c, 0xa578, 0x474b, 0x4c0f, 0x832c, 0x8868, 0x6a5b, 0x611f,
		0x0b23, 0x0067, 0xe254, 0xe910, 0x2633, 0x2d77, 0xcf44, 0xc400,
		0xb4b7, 0xbff3, 0x5dc0, 0x5684, 0x99a7, 0x92e3, 0x70d0, 0x7b94,
		0x11a8, 0x1aec, 0xf8df, 0xf39b, 0x3cb8, 0x37fc, 0xd5cf, 0xde8b,
		0xf08f, 0xfbcb, 0x19f8, 0x12bc, 0xdd9f, 0xd6db, 0x34e8, 0x3fac,
		0x5590, 0x5ed4, 0xbce7, 0xb7a3, 0x7880, 0x73c4, 0x91f7, 0x9ab3,
		0x2b26, 0x2062, 0xc251, 0xc915, 0x0636, 0x0d72, 0xef41, 0xe405,
		0x8e39, 0x857d, 0x674e, 0x6c0a, 0xa329, 0xa86d, 0x4a5e, 0x411a,
		0x6f1e, 0x645a, 0x8669, 0x8d2d, 0x420e, 0x494a, 0xab79, 0xa03d,
		0xca01, 0xc145, 0x2376, 0x2832, 0xe711, 0xec55, 0x0e66, 0x0522
	},
	{
		0x0000, 0x042b, 0xf8d1, 0xfcfa, 0x10ac, 0x1487, 0xe87d, 0xec56,
		0x17d3, 0x13f8, 0xef02, 0xeb29, 0x077f, 0x0354, 0xffae, 0xfb85,
		0xbd8f, 0xb9a4, 0x455e, 0x4175, 0xad23, 0xa908, 0x55f2, 0x51d9,
		0xaa5c, 0xae77, 0x528d, 0x56a6, 0xbaf0, 0xbedb, 0x4221, 0x460a,
		0x7a9f, 0x7eb4, 0x824e, 0x8665, 0x6a33, 0x6e18, 0x92e2, 0x96c9,
		0x6d4c, 0x6967, 0x959d, 0x91b6, 0x7de0, 0x79cb, 0x8531, 0x811a,
		0xc710, 0xc33b, 0x3fc1, 0x3bea, 0xd7bc, 0xd397, 0x2f6d, 0x2b46,
		0xd0c3, 0xd4e8, 0x2812, 0x2c39, 0xc06f, 0xc444, 0x38be, 0x3c95,
		0xfdd1, 0xf9fa, 0x0500, 0x012b, 0xed7d, 0xe956, 0x15ac, 0x1187,
		0xea02, 0xee29, 0x12d3, 0x16f8, 0xfaae, 0xfe85, 0x027f, 0x0654,
		0x405e, 0x4475, 0xb88f, 0xbca4, 0x50f2, 0x54d9, 0xa823, 0xac08,
		0x578d, 0x53a6, 0xaf5c, 0xab77, 0x4721, 0x430a, 0xbff0, 0xbbdb,
		0x874e, 0x8365, 0x7f9f, 0x7bb4, 0x97e2, 0x93c9, 0x6f33, 0x6b18,
		0x909d, 0x94b6, 0x684c, 0x6c67, 0x8031, 0x841a, 0x78e0, 0x7ccb,
		0x3ac1, 0x3eea, 0xc210, 0xc63b, 0x2a6d, 0x2e46, 0xd2bc, 0xd697,
		0x2d12, 0x2939, 0xd5c3, 0xd1e8, 0x3dbe, 0x3995, 0xc56f, 0xc144,
		0xc351, 0xc77a, 0x3b80, 0x3fab, 0xd3fd, 0xd7d6, 0x2b2c, 0x2f07,
		0xd482, 0xd0a9, 0x2c53, 0x2878, 0xc42e, 0xc005, 0x3cff, 0x38d4,
		0x7ede, 0x7af5, 0x860f, 0x8224, 0x6e72, 0x6a59, 0x96a3, 0x9288,
		0x690d, 0x6d26, 0x91dc, 0x95f7, 0x79a1, 0x7d8a, 0x8170, 0x855b,
		0xb9ce, 0xbde5, 0x411f, 0x4534, 0xa962, 0xad49, 0x51b3, 0x5598,
		0xae1d, 0xaa36, 0x56cc, 0x52e7, 0xbeb1, 0xba9a, 0x4660, 0x424b,
		0x0441, 0x006a, 0xfc90, 0xf8bb, 0x14ed, 0x10c6, 0xec3c, 0xe817,
		0x1392, 0x17b9, 0xeb43, 0xef68, 0x033e, 0x0715, 0xfbef, 0xffc4,
		0x3e80, 0x3aab, 0xc651, 0xc27a, 0x2e2c, 0x2a07, 0xd6fd, 0xd2d6,
		0x2953, 0x2d78, 0xd182, 0xd5a9, 0x39ff, 0x3dd4, 0xc12e, 0xc505,
		0x830f, 0x8724, 0x7bde, 0x7ff5, 0x93a3, 0x9788, 0x6b72, 0x6f59,
		0x94dc, 0x90f7, 0x6c0d, 0x6826, 0x8470, 0x805b, 0x7ca1, 0x788a,
		0x441f, 0x4034, 0xbcce, 0xb8e5, 0x54b3, 0x5098, 0xac62, 0xa849,
		0x53cc, 0x57e7, 0xab1d, 0xaf36, 0x4360, 0x474b, 0xbbb1, 0xbf9a,
		0xf990, 0xfdbb, 0x0141, 0x056a, 0xe93c, 0xed17, 0x11ed, 0x15c6,
		0xee43, 0xea68, 0x1692, 0x12b9, 0xfeef, 0xfac4, 0x063e, 0x0215
	},
	{
		0x0000, 0x9fd5, 0x38fc, 0xa729, 0x6f76, 0xf0a3, 0x578a, 0xc85f,
		0xe401, 0x7bd4, 0xdcfd, 0x4328, 0x8b77, 0x14a2, 0xb38b, 0x2c5e,
		0x8342, 0x1c97, 0xbbbe, 0x246b, 0xec34, 0x73e1, 0xd4c8, 0x4b1d,
		0x6743, 0xf896, 0x5fbf, 0xc06a, 0x0835, 0x97e0, 0x30c9, 0xaf1c,
		0x6c04, 0xf3d1, 0x54f8, 0xcb2d, 0x0372, 0x9ca7, 0x3b8e, 0xa45b,
		0x8805, 0x17d0, 0xb0f9, 0x2f2c, 0xe773, 0x78a6, 0xdf8f, 0x405a,
		0xef46, 0x7093, 0xd7ba, 0x486f, 0x8030, 0x1fe5, 0xb8cc, 0x2719,
		0x0b47, 0x9492, 0x33bb, 0xac6e, 0x6431, 0xfbe4, 0x5ccd, 0xc318,
		0x38f9, 0xa72c, 0x0005, 0x9fd0, 0x578f, 0xc85a, 0x6f73, 0xf0a6,
		0xdcf8, 0x432d, 0xe404, 0x7bd1, 0xb38e, 0x2c5b, 0x8b72, 0x14a7,
		0xbbbb, 0x246e, 0x8347, 0x1c92, 0xd4cd, 0x4b18, 0xec31, 0x73e4,
		0x5fba, 0xc06f, 0x6746, 0xf893, 0x30cc, 0xaf19, 0x0830, 0x97e5,
		0x54fd, 0xcb28, 0x6c01, 0xf3d4, 0x3b8b, 0xa45e, 0x0377, 0x9ca2,
		0xb0fc, 0x2f29, 0x8800, 0x17d5, 0xdf8a, 0x405f, 0xe776, 0x78a3,
		0xd7bf, 0x486a, 0xef43, 0x7096, 0xb8c9, 0x271c, 0x8035, 0x1fe0,
		0x33be, 0xac6b, 0x0b42, 0x9497, 0x5cc8, 0xc31d, 0x6434, 0xfbe1,
		0xbccf, 0x231a, 0x8433, 0x1be6, 0xd3b9, 0x4c6c, 0xeb45, 0x7490,
		0x58ce, 0xc71b, 0x6032, 0xffe7, 0x37b8, 0xa86d, 0x0f44, 0x9091,
		0x3f8d, 0xa058, 0x0771, 0x98a4, 0x50fb, 0xcf2e, 0x6807, 0xf7d2,
		0xdb8c, 0x4459, 0xe370, 0x7ca5, 0xb4fa, 0x2b2f, 0x8c06, 0x13d3,
		0xd0cb, 0x4f1e, 0xe837, 0x77e2, 0xbfbd, 0x2068, 0x8741, 0x1894,
		0x34ca, 0xab1f, 0x0c36, 0x93e3, 0x5bbc, 0xc469, 0x6340, 0xfc95,
		0x5389, 0xcc5c, 0x6b75, 0xf4a0, 0x3cff, 0xa32a, 0x0403, 0x9bd6,
		0xb788, 0x285d, 0x8f74, 0x10a1, 0xd8fe, 0x472b, 0xe002, 0x7fd7,
		0x8436, 0x1be3, 0xbcca, 0x231f, 0xeb40, 0x7495, 0xd3bc, 0x4c69,
		0x6037, 0xffe2, 0x58cb, 0xc71e, 0x0f41, 0x9094, 0x37bd, 0xa868,
		0x0774, 0x98a1, 0x3f88, 0xa05d, 0x6802, 0xf7d7, 0x50fe, 0xcf2b,
		0xe375, 0x7ca0, 0xdb89, 0x445c, 0x8c03, 0x13d6, 0xb4ff, 0x2b2a,
		0xe832, 0x77e7, 0xd0ce, 0x4f1b, 0x8744, 0x1891, 0xbfb8, 0x206d,
		0x0c33, 0x93e6, 0x34cf, 0xab1a, 0x6345, 0xfc90, 0x5bb9, 0xc46c,
		0x6b70, 0xf4a5, 0x538c, 0xcc59, 0x0406, 0x9bd3, 0x3cfa, 0xa32f,
		0x8f71, 0x10a4, 0xb78d, 0x2858, 0xe007, 0x7fd2, 0xd8fb, 0x472e
	},
	{
		0x0000, 0x7ebf, 0x3ddb, 0x4364, 0x16de, 0x6861, 0x2b05, 0x55ba,
		0xee6d, 0x90d2, 0xd3b6, 0xad09, 0xf8b3, 0x860c, 0xc568, 0xbbd7,
		0x9e95, 0xe02a, 0xa34e, 0xddf1, 0x884b, 0xf6f4, 0xb590, 0xcb2f,
		0x70f8, 0x0e47, 0x4d23, 0x339c, 0x6626, 0x1899, 0x5bfd, 0x2542,
		0x4648, 0x38f7, 0x7b93, 0x052c, 0x5096, 0x2e29, 0x6d4d, 0x13f2,
		0xa825, 0xd69a, 0x95fe, 0xeb41, 0xbefb, 0xc044, 0x8320, 0xfd9f,
		0xd8dd, 0xa662, 0xe506, 0x9bb9, 0xce03, 0xb0bc, 0xf3d8, 0x8d67,
		0x36b0, 0x480f, 0x0b6b, 0x75d4, 0x206e, 0x5ed1, 0x1db5, 0x630a,
		0x6a76, 0x14c9, 0x57ad, 0x2912, 0x7ca8, 0x0217, 0x4173, 0x3fcc,
		0x841b, 0xfaa4, 0xb9c0, 0xc77f, 0x92c5, 0xec7a, 0xaf1e, 0xd1a1,
		0xf4e3, 0x8a5c, 0xc938, 0xb787, 0xe23d, 0x9c82, 0xdfe6, 0xa159,
		0x1a8e, 0x6431, 0x2755, 0x59ea, 0x0c50, 0x72ef, 0x318b, 0x4f34,
		0x2c3e, 0x5281, 0x11e5, 0x6f5a, 0x3ae0, 0x445f, 0x073b, 0x7984,
		0xc253, 0xbcec, 0xff88, 0x8137, 0xd48d, 0xaa32, 0xe956, 0x97e9,
		0xb2ab, 0xcc14, 0x8f70, 0xf1cf, 0xa475, 0xdaca, 0x99ae, 0xe711,
		0x5cc6, 0x2279, 0x611d, 0x1fa2, 0x4a18, 0x34a7, 0x77c3, 0x097c,
		0xc147, 0xbff8, 0xfc9c, 0x8223, 0xd799, 0xa926, 0xea42, 0x94fd,
		0x2f2a, 0x5195, 0x12f1, 0x6c4e, 0x39f4, 0x474b, 0x042f, 0x7a90,
		0x5fd2, 0x216d, 0x6209, 0x1cb6, 0x490c, 0x37b3, 0x74d7, 0x0a68,
		0xb1bf, 0xcf00, 0x8c64, 0xf2db, 0xa761, 0xd9de, 0x9aba, 0xe405,
		0x870f, 0xf9b0, 0xbad4, 0xc46b, 0x91d1, 0xef6e, 0xac0a, 0xd2b5,
		0x6962, 0x17dd, 0x54b9, 0x2a06, 0x7fbc, 0x0103, 0x4267, 0x3cd8,
		0x199a, 0x6725, 0x2441, 0x5afe, 0x0f44, 0x71fb, 0x329f, 0x4c20,
		0xf7f7, 0x8948, 0xca2c, 0xb493, 0xe129, 0x9f96, 0xdcf2, 0xa24d,
		0xab31, 0xd58e, 0x96ea, 0xe855, 0xbdef, 0xc350, 0x8034, 0xfe8b,
		0x455c, 0x3be3, 0x7887, 0x0638, 0x5382, 0x2d3d, 0x6e59, 0x10e6,
		0x35a4, 0x4b1b, 0x087f, 0x76c0, 0x237a, 0x5dc5, 0x1ea1, 0x601e,
		0xdbc9, 0xa576, 0xe612, 0x98ad, 0xcd17, 0xb3a8, 0xf0cc, 0x8e73,
		0xed79, 0x93c6, 0xd0a2, 0xae1d, 0xfba7, 0x8518, 0xc67c, 0xb8c3,
		0x0314, 0x7dab, 0x3ecf, 0x4070, 0x15ca, 0x6b75, 0x2811, 0x56ae,
		0x73ec, 0x0d53, 0x4e37, 0x3088, 0x6532, 0x1b8d, 0x58e9, 0x2656,
		0x9d81, 0xe33e, 0xa05a, 0xdee5, 0x8b5f, 0xf5e0, 0xb684, 0xc83b
	},
};

/* Recompute the FCS with one more character appended. */
#define CalcFCS(fcs, c) (((fcs) >> 8) ^ crc16_table[0][((fcs) ^ (c)) & 0xff])

unsigned short AddCRC16(unsigned short fcs, void const *Buf,
			unsigned long long len)
{
   unsigned char const *buf = (unsigned char const *)Buf;
   for (uint32_t *current = (uint32_t*) Buf; len >= 4; len -= 4, buf += 4, current++) {
      uint32_t one = *current ^ fcs;
      fcs  = crc16_table[3][(one>>24) & 0xFF] ^
	   crc16_table[2][(one>>16) & 0xFF] ^
	   crc16_table[1][(one>> 8) & 0xFF] ^
	   crc16_table[0][ one      & 0xFF];
   }



   while (len--)
      fcs = CalcFCS(fcs, *buf++);
   return fcs;
}


static short crc32Lookup[8][256];

int main(void) {
    // same as before
    for (unsigned int i = 0; i <= 0xFF; i++)
    {
      uint16_t crc = i;
      for (unsigned int j = 0; j < 8; j++)
        crc = (crc >> 1) ^ ((crc & 1) * 0x8408);
      crc32Lookup[0][i] = crc;
    }
    for (unsigned int i = 0; i <= 0xFF; i++)
    {
      // for Slicing-by-4 and Slicing-by-8
      crc32Lookup[1][i] = (crc32Lookup[0][i] >> 8) ^ crc32Lookup[0][crc32Lookup[0][i] & 0xFF];
      crc32Lookup[2][i] = (crc32Lookup[1][i] >> 8) ^ crc32Lookup[0][crc32Lookup[1][i] & 0xFF];
      crc32Lookup[3][i] = (crc32Lookup[2][i] >> 8) ^ crc32Lookup[0][crc32Lookup[2][i] & 0xFF];
      // only Slicing-by-8
      crc32Lookup[4][i] = (crc32Lookup[3][i] >> 8) ^ crc32Lookup[0][crc32Lookup[3][i] & 0xFF];
      crc32Lookup[5][i] = (crc32Lookup[4][i] >> 8) ^ crc32Lookup[0][crc32Lookup[4][i] & 0xFF];
      crc32Lookup[6][i] = (crc32Lookup[5][i] >> 8) ^ crc32Lookup[0][crc32Lookup[5][i] & 0xFF];
      crc32Lookup[7][i] = (crc32Lookup[6][i] >> 8) ^ crc32Lookup[0][crc32Lookup[6][i] & 0xFF];
    }


    for (int j = 0; j < 8; j++) {
        printf("\t{\n\t\t");
        for (int i = 0; i < 256; i++) {
            printf("0x%04hx", crc32Lookup[j][i]);
            if (i == 255)
                printf("\n\t},\n");
            else if ((i + 1) % 8 == 0)
                printf(",\n\t\t");
            else
                printf(", ");
        }
    }
}
